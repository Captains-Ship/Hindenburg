<!doctype html>
<html class="default no-js">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Player Perspectives | @skeldjs/hindenburg</title>
	<meta name="description" content="Documentation for @skeldjs/hindenburg">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="../../assets/css/main.css">
	<link rel="stylesheet" href="../../assets/css/pages.css">
</head>
<body>
<header>
	<div class="tsd-page-toolbar">
		<div class="container">
			<div class="table-wrap">
				<div class="table-cell" id="tsd-search" data-index="../../assets/js/search.json" data-base="../..">
					<div class="field">
						<label for="tsd-search-field" class="tsd-widget search no-caption">Search</label>
						<input id="tsd-search-field" type="text" />
					</div>
					<ul class="results">
						<li class="state loading">Preparing search index...</li>
						<li class="state failure">The search index is not available</li>
					</ul>
					<a href="../../index.html" class="title">@skeldjs/hindenburg</a>
				</div>
				<div class="table-cell" id="tsd-widgets">
					<div id="tsd-filter">
						<a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a>
						<div class="tsd-filter-group">
							<div class="tsd-select" id="tsd-filter-visibility">
								<span class="tsd-select-label">All</span>
								<ul class="tsd-select-list">
									<li data-value="public">Public</li>
									<li data-value="protected">Public/Protected</li>
									<li data-value="private" class="selected">All</li>
								</ul>
							</div>
							<input type="checkbox" id="tsd-filter-inherited" checked />
							<label class="tsd-widget" for="tsd-filter-inherited">Inherited</label>
							<input type="checkbox" id="tsd-filter-externals" checked />
							<label class="tsd-widget" for="tsd-filter-externals">Externals</label>
							<input type="checkbox" id="tsd-filter-only-exported" />
							<label class="tsd-widget" for="tsd-filter-only-exported">Only exported</label>
						</div>
					</div>
					<a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a>
				</div>
			</div>
		</div>
	</div>
	<div class="tsd-page-title">
		<div class="container">
			<ul class="tsd-breadcrumb">
				<li>
					<a href="../../modules.html">Globals</a>
				</li>
				<li>
					<a href="Getting Started.html">Writing Plugins</a>
				</li>
				<li>
					<a href="Player Perspectives.html">Player Perspectives</a>
				</li>
			</ul>
			<h1>Player Perspectives</h1>
		</div>
	</div>
</header>
<div class="container container-main">
	<div class="row">
		<div class="col-8 col-content">
			<div class="tsd-panel tsd-typography">
				<a href="#player-perspectives" id="player-perspectives" style="color: inherit; text-decoration: none;">
					<h1>Player Perspectives</h1>
				</a>
				<p>Individual player perspectives, in the broadest sense, allow you to execute
					functions for a single player, while every other player wouldn&#39;t see a change
				at all.</p>
				<p>This could be, for example, making a player appear a colour on one player&#39;s
				screen while appearing a completely different colour on another&#39;s.</p>
				<p>Hindenburg provides a useful API to allow you to write extremely powerful plugins
					that utilise the ideas behind individual player perspectives, as well as making
				sure that desync is handled correctly and prevent it from getting too out-of-control.</p>
				<a href="#when-to-use-player-perspectives" id="when-to-use-player-perspectives" style="color: inherit; text-decoration: none;">
					<h3>When to Use Player Perspectives</h3>
				</a>
				<p>Player perspectives in general should be seen as cloning the entire room, and
				doing the same process for rooms when each packet is received.</p>
				<p>Knowing this, perspectives can be expensive for the server in terms of memory
				usage <em>and</em> performance..</p>
				<p>They shouldn&#39;t be used in large loops, or in events that are fired often.</p>
				<a href="#how-they-work" id="how-they-work" style="color: inherit; text-decoration: none;">
					<h3>How They Work</h3>
				</a>
				<p>Player perspectives can be thought of as a sandbox, or a mirror of the room for
					players, where nothing in that perspective has any effect on the original room
				and players in that room. Only players in the perspective will see any changes.</p>
				<p>By default, the perspective gets updated on every single thing the room gets
					updated on, meaning that they essentially contain the same information and remain
				that way.</p>
				<p>It gets interesting, however, when you add filters to incoming and outgoing packets
				from the perspective. This allows you to desychronise features of the room.</p>
				<pre><code class="language-ts"><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">perspective</span><span style="color: #000000"> = </span><span style="color: #001080">room</span><span style="color: #000000">.</span><span style="color: #795E26">createPerspective</span><span style="color: #000000">(</span><span style="color: #001080">somePlayer</span><span style="color: #000000">, [</span>
<span style="color: #000000">    </span><span style="color: #001080">PresetFilter</span><span style="color: #000000">.</span><span style="color: #001080">GameDataUpdates</span>
<span style="color: #000000">]);</span>
</code></pre>
				<a href="#example" id="example" style="color: inherit; text-decoration: none;">
					<h3>Example</h3>
				</a>
				<p>For example, you might want to make a player get &quot;blinded&quot;, and not be able to
					tell players apart by making them all black and giving them a jumbled-up name.
					Every other player, however, would see no difference at all, and the game would
				continue as normal for them.</p>
				<p>Note that filters don&#39;t block <em>every</em> packet coming in and out, you might still
					want players to move around the same way for the player as they do for everyone
					else, just that their name, colours, hats, etc. give no clues to who the actual
				players are.</p>
				<p>This example can be implemented in just 12 lines of code:</p>
				<pre><code class="language-ts"><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">perspective</span><span style="color: #000000"> = </span><span style="color: #001080">room</span><span style="color: #000000">.</span><span style="color: #795E26">createPerspective</span><span style="color: #000000">(</span><span style="color: #001080">somePlayer</span><span style="color: #000000">, [</span>
<span style="color: #000000">    </span><span style="color: #001080">PresetFilter</span><span style="color: #000000">.</span><span style="color: #001080">GameDataUpdates</span>
<span style="color: #000000">]);</span>

<span style="color: #AF00DB">for</span><span style="color: #000000"> (</span><span style="color: #0000FF">const</span><span style="color: #000000"> [ , </span><span style="color: #0070C1">player</span><span style="color: #000000"> ] </span><span style="color: #0000FF">of</span><span style="color: #000000"> </span><span style="color: #001080">perspective</span><span style="color: #000000">.</span><span style="color: #001080">players</span><span style="color: #000000">) {</span>
<span style="color: #000000">    </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">playerControl</span><span style="color: #000000"> = </span><span style="color: #001080">player</span><span style="color: #000000">.</span><span style="color: #001080">control</span><span style="color: #000000">!;</span>

<span style="color: #000000">    </span><span style="color: #001080">playerControl</span><span style="color: #000000">.</span><span style="color: #795E26">setColor</span><span style="color: #000000">(</span><span style="color: #001080">Color</span><span style="color: #000000">.</span><span style="color: #001080">Black</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #001080">playerControl</span><span style="color: #000000">.</span><span style="color: #795E26">setName</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;?????&quot;</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #001080">playerControl</span><span style="color: #000000">.</span><span style="color: #795E26">setHat</span><span style="color: #000000">(</span><span style="color: #001080">Hat</span><span style="color: #000000">.</span><span style="color: #001080">None</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #001080">playerControl</span><span style="color: #000000">.</span><span style="color: #795E26">setPet</span><span style="color: #000000">(</span><span style="color: #001080">Pet</span><span style="color: #000000">.</span><span style="color: #001080">None</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #001080">playerControl</span><span style="color: #000000">.</span><span style="color: #795E26">setSkin</span><span style="color: #000000">(</span><span style="color: #001080">Skin</span><span style="color: #000000">.</span><span style="color: #001080">None</span><span style="color: #000000">);</span>
<span style="color: #000000">}</span>

<span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #795E26">sleep</span><span style="color: #000000">(</span><span style="color: #098658">10000</span><span style="color: #000000">);</span>

<span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #001080">perspective</span><span style="color: #000000">.</span><span style="color: #795E26">destroyPerspective</span><span style="color: #000000">();</span>
</code></pre>
				<a href="#destroying-perspectives" id="destroying-perspectives" style="color: inherit; text-decoration: none;">
					<h3>Destroying Perspectives</h3>
				</a>
				<p>Destroying a perspective by default will restore the entire room for these players,
				resetting the entire room to what it should be. You can prevent this behaviour:</p>
				<pre><code class="language-ts"><span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #001080">perspective</span><span style="color: #000000">.</span><span style="color: #795E26">destroyPerspective</span><span style="color: #000000">(</span><span style="color: #0000FF">false</span><span style="color: #000000">);</span>
</code></pre>
				<a href="#perspective-packet-filters" id="perspective-packet-filters" style="color: inherit; text-decoration: none;">
					<h3>Perspective Packet Filters</h3>
				</a>
				<p>Hindenburg has some preset packet filters in the <a href="../../enums/presetfilter.html">PresetFilter</a> enum to
				help you write perspectives quicker and more consicely with common use-cases.</p>
				<p>You can pass these presets into the <a href="../../classes/room.html#createperspective">Room.createPerspective</a> method:</p>
				<pre><code class="language-ts"><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">perspective</span><span style="color: #000000"> = </span><span style="color: #001080">room</span><span style="color: #000000">.</span><span style="color: #795E26">createPerspective</span><span style="color: #000000">(</span><span style="color: #001080">somePlayer</span><span style="color: #000000">, [</span>
<span style="color: #000000">    </span><span style="color: #001080">PresetFilter</span><span style="color: #000000">.</span><span style="color: #001080">GameDataUpdates</span>
<span style="color: #000000">]);</span>
</code></pre>
				<p>Otherwise, you can create your own filters via the <code>incomingFilter</code> and <code>outgoingFilter</code>
					properties. These are instances of skeldjs&#39; <a href="../../classes/packetdecoder.html">PacketDecoder</a>, and thus have
				the same API. Use <code>message.cancel</code> to prevent the message from going through.</p>
				<p>Check out <a href="https://github.com/codyphobe/among-us-protocol">codyphobe&#39;s wiki</a> if
				you are unfamiliar with the among us protocol.</p>
				<p>For example, you might want to prevent movement packets coming from the host of
				the room from going through:</p>
				<pre><code class="language-ts"><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">perspective</span><span style="color: #000000"> = </span><span style="color: #001080">room</span><span style="color: #000000">.</span><span style="color: #795E26">createPerspective</span><span style="color: #000000">(</span><span style="color: #001080">somePlayer</span><span style="color: #000000">);</span>

<span style="color: #001080">perspective</span><span style="color: #000000">.</span><span style="color: #001080">incomingFilter</span><span style="color: #000000">.</span><span style="color: #795E26">on</span><span style="color: #000000">(</span><span style="color: #001080">DataMessage</span><span style="color: #000000">, </span><span style="color: #001080">message</span><span style="color: #000000"> </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">netobject</span><span style="color: #000000"> = </span><span style="color: #001080">perspective</span><span style="color: #000000">.</span><span style="color: #001080">netobjects</span><span style="color: #000000">.</span><span style="color: #795E26">get</span><span style="color: #000000">(</span><span style="color: #001080">message</span><span style="color: #000000">.</span><span style="color: #001080">netid</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #AF00DB">if</span><span style="color: #000000"> (</span>
<span style="color: #000000">        </span><span style="color: #001080">netobject</span><span style="color: #000000">?.</span><span style="color: #001080">classname</span><span style="color: #000000"> === </span><span style="color: #A31515">&quot;CustomNetworkTransform&quot;</span><span style="color: #000000"> &amp;&amp;</span>
<span style="color: #000000">        </span><span style="color: #001080">netobject</span><span style="color: #000000">.</span><span style="color: #001080">ownerid</span><span style="color: #000000"> === </span><span style="color: #001080">perspective</span><span style="color: #000000">.</span><span style="color: #001080">hostid</span>
<span style="color: #000000">    ) {</span>
<span style="color: #000000">        </span><span style="color: #001080">message</span><span style="color: #000000">.</span><span style="color: #795E26">cancel</span><span style="color: #000000">(); </span><span style="color: #008000">// prevent this message from going through</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">});</span>
</code></pre>
				<p>Note that by default, the incoming filter and the outgoing filter are exactly
					the same, meaning that if you prevent host movement packets from coming in, they&#39;re
				not going to be able to get out either.</p>
				<p>You can override this behaviour however by simply re-assigning the outgoing filter:</p>
				<pre><code class="language-ts"><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">perspective</span><span style="color: #000000"> = </span><span style="color: #001080">room</span><span style="color: #000000">.</span><span style="color: #795E26">createPerspective</span><span style="color: #000000">(</span><span style="color: #001080">somePlayer</span><span style="color: #000000">);</span>
<span style="color: #001080">perspective</span><span style="color: #000000">.</span><span style="color: #001080">outgoingFilter</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">PerspectiveFilter</span><span style="color: #000000">(</span><span style="color: #001080">perspective</span><span style="color: #000000">);</span>

<span style="color: #008000">// perspective.outgoingFilter !== perspective.incomingFilter</span>
</code></pre>
				<p>Other than the above features, the API for perspectives is precisely the same as
					any other room, and other than packets specified in the filters, will affect the
				original room the same as executing the exact same functions on it.</p>
			</div>
		</div>
		<div class="col-4 col-menu menu-sticky-wrap menu-highlight">
			<nav class="tsd-navigation primary">
				<ul>
					<li class="label pp-nav pp-group">
						<span>Setting <wbr>Up</span>
					</li>
					<li class=" pp-nav pp-page">
						<a href="../Setting Up/Installation.html">Installation</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="../Setting Up/Plugins.html">Plugins</a>
					</li>
					<li class="label pp-nav pp-group">
						<span>Using <wbr>Hindenburg</span>
					</li>
					<li class=" pp-nav pp-page">
						<a href="../Using Hindenburg/Interactive CLI.html">Interactive CLI</a>
					</li>
					<li class="label pp-nav pp-group">
						<span>Writing <wbr>Plugins</span>
					</li>
					<li class=" pp-nav pp-page">
						<a href="Getting Started.html">Getting <wbr>Started</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="Publishing Plugins to NPM.html">Publishing <wbr>Plugins to NPM</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="Plugin Lifecycle Methods.html">Plugin <wbr>Lifecycle <wbr>Methods</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="Event Listeners.html">Event <wbr>Listeners</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="Splitting Plugin Listeners.html">Splitting <wbr>Plugin <wbr>Listeners</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="Chat Commands.html">Chat <wbr>Commands</a>
					</li>
					<li class=" pp-nav pp-page">
						<a href="Terminal Commands.html">Terminal <wbr>Commands</a>
					</li>
					<li class="current pp-nav pp-page">
						<a href="Player Perspectives.html">Player <wbr>Perspectives</a>
					</li>
					<li class="label pp-nav pp-group">
						<span>API</span>
					</li>
					<li class=" ">
						<a href="../../modules.html">Exports</a>
					</li>
				</ul>
			</nav>
			<nav class="tsd-navigation secondary menu-sticky">
				<ul class="before-current">
				</ul>
			</nav>
		</div>
	</div>
</div>
<footer class="with-border-bottom">
	<div class="container">
		<h2>Legend</h2>
		<div class="tsd-legend-group">
			<ul class="tsd-legend">
				<li class="tsd-kind-constructor tsd-parent-kind-class"><span class="tsd-kind-icon">Constructor</span></li>
				<li class="tsd-kind-property tsd-parent-kind-class"><span class="tsd-kind-icon">Property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class"><span class="tsd-kind-icon">Method</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-constructor tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited constructor</span></li>
				<li class="tsd-kind-property tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited method</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-constructor tsd-parent-kind-interface"><span class="tsd-kind-icon">Constructor</span></li>
				<li class="tsd-kind-property tsd-parent-kind-interface"><span class="tsd-kind-icon">Property</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-property tsd-parent-kind-class tsd-is-static"><span class="tsd-kind-icon">Static property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class tsd-is-static"><span class="tsd-kind-icon">Static method</span></li>
			</ul>
		</div>
	</div>
</footer>
<div class="container tsd-generator">
	<p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p>
</div>
<div class="overlay"></div>
<script src="../../assets/js/main.js"></script>
<script>if (location.protocol == 'file:') document.write('<script src="../../assets/js/search.json"><' + '/script>');</script>
</body>
</html>